<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    

<head>
    <meta charset="utf-8">
    <meta name="keywords" content="G++编译C++程序, FunU">
    <meta name="description" content="C++ 编程中相关文件后缀

静态库 (archive) .a
C++源代码（需要编译预处理）.C .c .cc .cp .cpp .cxx .c++
C或者C++源代码头文件 .h
C++源代码（不需编译预处理） .ii
对象文件 .o
">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>G++编译C++程序 | FunU</title>
    <link rel="icon" type="image/png" href="/favicon.ico">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

</head>

<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="container">
            <div class="nav-wrapper">
                <div class="brand-logo">
                    <a href="/" class="waves-effect waves-light">
                        
                        <img src="/res/logo.png" class="logo-img hide-on-small-only">
                        
                        <span class="logo-span">FunU</span>
                    </a>
                </div>
                <a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>Index</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>Tags</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>Categories</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>Archives</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>About</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>Friends</span>
        </a>
    </li>
    
    <li>
        <a id="toggleSearch" class="waves-effect waves-light">
            <i id="searchIcon" class="mdi-action-search"></i>
        </a>
    </li>

</ul>

<div class="side-nav" id="mobile-nav">

    <div class="mobile-head bg-color">
        
        <img src="/res/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">FunU</div>
        <div class="logo-desc">
            
            刊落锋颖，一味恬静
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                Index
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                Tags
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                Categories
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                Archives
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                About
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                Friends
            </a>
        </li>
        
        
    </ul>

    <div class="social-link"><a href="https://github.com/" class="tooltipped" target="_blank" data-tooltip="-> Gituhb"
    data-position="top" data-delay="50">
    <i class="fa fa-github fa-lg"></i>
</a>
<a href="https://twitter.com" class="tooltipped" data-tooltip="-> Twitter" data-position="top" data-delay="50">
    <i class="fa fa-twitter fa-lg"></i>
</a>
<a href="https://facebook.com" class="tooltipped" data-tooltip="-> Facebook" data-position="top" data-delay="50">
    <i class="fa fa-facebook-official fa-lg"></i>
</a>
<a href="https://instagram.com" class="tooltipped" data-tooltip="-> Ins" data-position="top" data-delay="50">
    <i class="fa fa-instagram fa-lg"></i>
</a>
</div>
</div>

            </div>
        </div>

        
    </nav>
</header>





<div class="bg-cover post-cover" style="background-image: url('/res/img/24.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        G++编译C++程序
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1,
    #articleContent h2,
    #articleContent h3,
    #articleContent h4,
    #articleContent h5,
    #articleContent h6 {
        padding-top: 76px;
        margin-top: -76px;
    }

    #articleContent h1 {
        line-height: 3.5rem;
    }

    #articleContent h2 {
        line-height: 3.2rem;
    }

    #articleContent h3 {
        line-height: 2.8rem;
    }

    #articleContent h4 {
        line-height: 2.5rem;
    }

    #articleContent h5 {
        line-height: 2.2rem;
    }

    #articleContent h6 {
        line-height: 1.9rem;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }
</style>
<div class="row">
    <div class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            
            <div class="article-tag">
                
                <a href="/tags/g/" target="_blank">
                    <span class="chip bg-color">g++</span>
                </a>
                
                <a href="/tags/cpp/" target="_blank">
                    <span class="chip bg-color">cpp</span>
                </a>
                
            </div>
            
            <div class="post-info">
                
                <span class="post-cate">
                    <i class="fa fa-bookmark fa-fw icon-category"></i>
                    
                    <a href="/categories/GNU/" class="post-category" target="_blank">
                        GNU
                    </a>
                    
                </span>
                

                <span class="post-date">
                    <i class="fa fa-clock-o fa-fw"></i>2017-09-14
                </span>
            </div>
        </div>
        <hr>
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="C-编程中相关文件后缀"><a href="#C-编程中相关文件后缀" class="headerlink" title="C++ 编程中相关文件后缀"></a>C++ 编程中相关文件后缀</h1><a id="more"></a>
<ul>
<li>静态库 (archive) <code>.a</code></li>
<li>C++源代码（需要编译预处理）<code>.C</code> <code>.c</code> <code>.cc</code> <code>.cp</code> <code>.cpp</code> <code>.cxx</code> <code>.c++</code></li>
<li>C或者C++源代码头文件 <code>.h</code></li>
<li>C++源代码（不需编译预处理） <code>.ii</code></li>
<li>对象文件 <code>.o</code></li>
<li>汇编语言代码 <code>.s</code></li>
<li>动态库 <code>.so</code></li>
</ul>
<h1 id="单个源文件生成可执行程序"><a href="#单个源文件生成可执行程序" class="headerlink" title="单个源文件生成可执行程序"></a>单个源文件生成可执行程序</h1><p>下面是一个保存在文件 <code>helloworld.cpp</code> 中一个简单的 C++ 程序的代码：</p>
<pre class="line-numbers language-c++"><code class="language-c++">/* helloworld.cpp */
#include int main(int argc,char*argv[]){
    std::cout << "hello, world" << std::endl;
    return(0);
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>程序使用定义在头文件 <code>iostream</code> 中的 <code>cout</code>，向标准输出写入一个简单的字符串。该代码可用以下命令编译为可执行文件：</p>
<pre class="line-numbers language-bash"><code class="language-bash">g++ helloworld.cpp
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>编译器 <code>g++</code> 通过检查命令行中指定的文件的后缀名可识别其为 C++ 源代码文件。</p>
<p>编译器默认的动作：编译源代码文件生成对象文件(object file)，链接对象文件和 libstdc++ 库中的函数得到可执行程序。然后删除对象文件。由于命令行中未指定可执行程序的文件名，编译器采用默认的 a.out。程序可以这样来运行：</p>
<pre class="line-numbers language-bash"><code class="language-bash">./a.out
hello, world
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>更普遍的做法是通过 <code>-o</code> 选项指定可执行程序的文件名。下面的命令将产生名为 helloworld 的可执行文件：</p>
<pre class="line-numbers language-bash"><code class="language-bash">g++ helloworld.cpp -o helloworld
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在命令行中输入程序名可使之运行：</p>
<pre class="line-numbers language-bash"><code class="language-bash">./helloworld
hello, world
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>程序 g++ 是将 gcc 默认语言设为 C++ 的一个特殊的版本，链接时它自动使用 C++ 标准库而不用 C 标准库。通过遵循源码的命名规范并指定对应库的名字，用 gcc 来编译链接 C++ 程序是可行的，如下例所示：</p>
<pre class="line-numbers language-bash"><code class="language-bash">gcc helloworld.cpp -lstdc++ -o helloworld
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>选项 -l (ell) 通过添加前缀 lib 和后缀 .a 将跟随它的名字变换为库的名字 <code>libstdc++.a</code>。而后它在标准库路径中查找该库。</p>
<p>gcc 的编译过程和输出文件与 g++ 是完全相同的。</p>
<p>在大多数系统中，GCC 安装时会安装一名为 c++ 的程序。如果被安装，它和 g++ 是等同，如下例所示，用法也一致：</p>
<pre class="line-numbers language-bash"><code class="language-bash">c++ helloworld.cpp -o helloworld
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1 id="多个源文件生成可执行程序"><a href="#多个源文件生成可执行程序" class="headerlink" title="多个源文件生成可执行程序"></a>多个源文件生成可执行程序</h1><p>如果多于一个的源码文件在 g++ 命令中指定，它们都将被编译并被链接成一个单一的可执行文件。</p>
<p>下面是一个名为 <code>speak.h</code> 的头文件；它包含一个仅含有一个函数的类的定义：</p>
<pre class="line-numbers language-c++"><code class="language-c++">/* speak.h */
#include class Speak{
    public:void sayHello(constchar*);
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>下面列出的是文件 <code>speak.cpp</code> 的内容：包含 <code>sayHello()`</code> 函数的函数体：</p>
<pre class="line-numbers language-c++"><code class="language-c++">/* speak.cpp */
#include "speak.h"
void Speak::sayHello(constchar*str){
    std::cout << "Hello " << str << "\n";
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>文件 <code>hellospeak.cpp</code> 内是一个使用 Speak 类的程序：</p>
<pre class="line-numbers language-c++"><code class="language-c++">/* hellospeak.cpp */
#include "speak.h"
int main(int argc,char*argv[]){
    Speak speak;
    speak.sayHello("world");
    return(0);
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>下面这条命令将上述两个源码文件编译链接成一个单一的可执行程序：</p>
<pre class="line-numbers language-bash"><code class="language-bash">g++ hellospeak.cpp speak.cpp -o hellospeak
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>PS：这里说一下为什么在命令中没有提到“speak.h“该文件</p>
<p>原因是：在<code>speak.cpp</code>中包含有<code>#include&quot;speak.h&quot;</code>这句代码，它的意思是搜索系统头文件目录之前将先在当前目录中搜索文件<code>speak.h</code>。而<code>speak.h</code>正在该目录中，不用再在命令中指定了。</p>
<h1 id="源文件生成对象文件"><a href="#源文件生成对象文件" class="headerlink" title="源文件生成对象文件"></a>源文件生成对象文件</h1><p>选项 <code>-c</code> 用来告诉编译器编译源代码但不要执行链接，输出结果为对象文件。文件默认名与源码文件名相同，只是将其后缀变为 <code>.o</code>。</p>
<p>例如，下面的命令将编译源码文件 <code>hellospeak.cpp</code> 并生成对象文件 <code>hellospeak.o</code>：</p>
<pre class="line-numbers language-bash"><code class="language-bash">g++ -c hellospeak.cpp
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>命令 g++ 也能识别 <code>.o</code> 文件并将其作为输入文件传递给链接器。下列命令将编译源码文件为对象文件并将其链接成单一的可执行程序：</p>
<pre class="line-numbers language-bash"><code class="language-bash">g++ -c hellospeak.cpp
g++ -c speak.cpp
g++ hellospeak.o speak.o -o hellospeak
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>选项 <code>-o</code> 不仅仅能用来命名可执行文件。它也用来命名编译器输出的其他文件。例如：除了中间的对象文件有不同的名字外，下列命令将生成和上面完全相同的可执行文件：</p>
<pre class="line-numbers language-bash"><code class="language-bash">g++ -c hellospeak.cpp -o hspk1.o 
g++ -c speak.cpp -o hspk2.o 
g++ hspk1.o hspk2.o -o hellospeak
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h1 id="编译预处理"><a href="#编译预处理" class="headerlink" title="编译预处理"></a>编译预处理</h1><p>选项 <code>-E</code> 使 g++ 将源代码用编译预处理器处理后不再执行其他动作。</p>
<p>下面的命令预处理源码文件 <code>helloworld.cpp</code> 并将结果显示在标准输出中：</p>
<pre class="line-numbers language-bash"><code class="language-bash">g++ -E helloworld.cpp
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>本文前面所列出的 <code>helloworld.cpp</code> 的源代码，仅仅有六行，而且该程序除了显示一行文字外什么都不做，但是，预处理后的版本将超过 1200 行。这主要是因为头文件 <code>iostream</code> 被包含进来，而且它又包含了其他的头文件，除此之外，还有若干个处理输入和输出的类的定义。</p>
<p>预处理过的文件的 GCC 后缀为 <code>.ii</code>，它可以通过 <code>-o</code> 选项来生成，例如：</p>
<pre class="line-numbers language-bash"><code class="language-bash">gcc -E helloworld.cpp -o helloworld.ii
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1 id="生成汇编代码"><a href="#生成汇编代码" class="headerlink" title="生成汇编代码"></a>生成汇编代码</h1><p>选项 <code>-S</code> 指示编译器将程序编译成汇编语言，输出汇编语言代码而后结束。</p>
<p>下面的命令将由 C++ 源码文件生成汇编语言文件 <code>helloworld.s</code>：</p>
<pre class="line-numbers language-bash"><code class="language-bash">g++ -S helloworld.cpp
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>生成的汇编语言依赖于编译器的目标平台。</p>
<h1 id="创建静态库"><a href="#创建静态库" class="headerlink" title="创建静态库"></a>创建静态库</h1><p>静态库是编译器生成的一系列对象文件的集合。</p>
<p>链接一个程序时用库中的对象文件还是目录中的对象文件都是一样的。库中的成员包括普通函数，类定义，类的对象实例等等。静态库的另一个名字叫归档文件(archive)，管理这种归档文件的工具叫 <code>ar</code> 。</p>
<p>在下面的例子中，我们先创建两个对象模块，然后用其生成静态库。</p>
<p>头文件 <code>say.h</code> 包含函数 <code>sayHello()</code> 的原型和类 Say 的定义：</p>
<pre class="line-numbers language-c++"><code class="language-c++">/* say.h */
#include void sayhello(void);
class Say {
private:
    char*string;
public:
    Say(char*str){
        string= str;
    }
    void sayThis(constchar*str){
        std::cout << str << " from a static library\n";
    }
    void sayString(void);
};
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>下面是文件 <code>say.cpp</code> 是我们要加入到静态库中的两个对象文件之一的源码。它包含 Say 类中 <code>sayString()</code> 函数的定义体；类 Say 的一个实例 librarysay 的声明也包含在内：</p>
<pre class="line-numbers language-c++"><code class="language-c++">/* say.cpp */
#include "say.h"
void Say::sayString(){
    std::cout << string << "\n";
}
Say librarysay("Library instance of Say");
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>源码文件 <code>sayhello.cpp</code> 是我们要加入到静态库中的第二个对象文件的源码。它包含函数 <code>sayhello()</code> 的定义：</p>
<pre class="line-numbers language-c++"><code class="language-c++">/* sayhello.cpp */
#include "say.h"
void sayhello(){
    std::cout << "hello from a static library\n";
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>下面的命令序列将源码文件编译成对象文件，命令 <code>ar</code> 将其存进库中：</p>
<pre class="line-numbers language-bash"><code class="language-bash">g++ -c sayhello.cpp
g++ -c say.cpp
ar -r libsay.a sayhello.o say.o
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>程序 <code>ar</code> 配合参数 <code>-r</code> 创建一个新库 <code>libsay.a</code> 并将命令行中列出的对象文件插入。采用这种方法，如果库不存在的话，参数 <code>-r</code> 将创建一个新的库，而如果库存在的话，将用新的模块替换原来的模块。</p>
<p>下面是主程序 <code>saymain.cpp</code>，它调用库 <code>libsay.a</code> 中的代码：</p>
<pre class="line-numbers language-c++"><code class="language-c++">/* saymain.cpp */
#include "say.h"
int main(int argc,char*argv[]){
    extern Say librarysay;
    Say localsay = Say("Local instance of Say");
    sayhello();
    librarysay.sayThis("howdy");
    librarysay.sayString();
    localsay.sayString();
    return(0);
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>该程序可以下面的命令来编译和链接：</p>
<pre class="line-numbers language-bash"><code class="language-bash">g++ saymain.cpp libsay.a -o saymain
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>程序运行时，产生以下输出：</p>
<pre><code>hello from a static library
howdy from a static library
Library instance of Say
Local instance of Say
</code></pre><p>本文来自： <a href="http://wiki.ubuntu.org.cn/Compiling_Cpp" target="_blank" rel="noopener">http://wiki.ubuntu.org.cn/Compiling_Cpp</a> </p>
<p>ps：如果一个文件夹下有多个cpp文件需要编译的话，除了采用makefile的方式之外，还可以使用</p>
<pre class="line-numbers language-bash"><code class="language-bash">g++ *.cpp -o hello
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>hello为编译生成的可执行文件的名字，编译时要确保cpp文件和他们各自所引用的头文件在同一个目录下。</p>
<h1 id="C-C-源代码到可执行程序的过程详解"><a href="#C-C-源代码到可执行程序的过程详解" class="headerlink" title="C/C++源代码到可执行程序的过程详解"></a>C/C++源代码到可执行程序的过程详解</h1><p>参考自</p>
<ul>
<li><a href="https://www.cnblogs.com/sanghai/archive/2013/11/01/3401865.html" target="_blank" rel="noopener">https://www.cnblogs.com/sanghai/archive/2013/11/01/3401865.html</a></li>
<li><a href="http://blog.csdn.net/syp35/article/details/77774279" target="_blank" rel="noopener">http://blog.csdn.net/syp35/article/details/77774279</a></li>
</ul>
<p><strong>源代码(cpp)–&gt;预处理–&gt;(cpp)–&gt;编译–&gt;(汇编语言)–&gt;优化–&gt;(汇编语言)–&gt;汇编过程–&gt;(机器语言)–&gt;链接–&gt;(二进制机器语言)–&gt;可执行文件</strong></p>
<h2 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h2><p>读取c源程序，对其中的伪指令（以#开头的指令）和特殊符号进行处理</p>
<p>伪指令主要包括以下四个方面</p>
<ol>
<li><p>宏定义指令</p>
<p> 如<code>#define Name TokenString</code>,<code>#undef</code>等。对于前一个伪指令，预编译所要做的是将程序中的所有Name用TokenString替换，但作为字符串常量的Name则不被替换。对于后者，则将取消对某个宏的定义，使以后该串的出现不再被替换。</p>
</li>
<li><p>条件编译指令</p>
<p> 如<code>#ifdef</code>,<code>#ifndef</code>,<code>#else</code>,<code>#elif</code>,<code>#endif</code>,等等。这些伪指令的引入使得程序员可以通过定义不同的宏来决定编译程序对哪些代码进行处理。预编译程序将根据有关的文件，将那些不必要的代码过滤掉。</p>
</li>
<li><p>头文件包含指令</p>
<p> 如<code>#include &quot;FileName&quot;</code>或者<code>#include &lt;FileName&gt;</code>等。在头文件中一般用伪指令<code>#define</code>定义了大量的宏（最常见的是字符常量），同时包含有各种外部符号的声明。采用头文件的目的主要是为了使某些定义可以供多个不同的C源程序使用。因为在需要用到这些定义的C源程序中，只需加上一条#include语句即可，而不必再在此文件中将这些定义重复一遍。</p>
<p> 预编译程序将把头文件中的定义统统都加入到它所产生的输出文件中，以供编译程序对之进行处理。</p>
</li>
<li><p>特殊符号</p>
<p> 预编译程序可以识别一些特殊的符号。例如在源程序中出现的<code>LINE</code>标识将被解释为当前行号（十进制数），<code>FILE</code>则被解释为当前被编译的C源程序的名称。预编译程序对于在源程序中出现的这些串将用合适的值进行替换。</p>
</li>
</ol>
<p>预编译程序所完成的基本上是对源程序的“替代”工作。经过此种替代，生成一个没有宏定义、没有条件编译指令、没有特殊符号的输出文件。这个文件的含义同没有经过预处理的源文件是相同的，但内容有所不同。下一步，此输出文件将作为编译程序的输出而被翻译成为机器指令。</p>
<p>采用<code>g++ -E test.cpp -o test.ii</code>命令可以生成预处理文件，一个97字节的helloworld程序，会生成一个411K的预处理文件，只因为包含了iostream。</p>
<h2 id="编译阶段"><a href="#编译阶段" class="headerlink" title="编译阶段"></a>编译阶段</h2><p>经过预编译得到的输出文件中，将只有常量。如数字、字符串、变量的定义，以及C语言的关键字，如<code>main,if,else,for,while,{,},+,-,*,\</code>，等等。预编译程序所要作得工作就是通过词法分析和语法分析，在确认所有的指令都符合语法规则之后，将其翻译成等价的中间代码表示或汇编代码。</p>
<h2 id="优化阶段"><a href="#优化阶段" class="headerlink" title="优化阶段"></a>优化阶段</h2><p>优化处理是编译系统中一项比较艰深的技术。它涉及到的问题不仅同编译技术本身有关，而且同机器的硬件环境也有很大的关系。</p>
<ul>
<li><p>优化一部分是对中间代码的优化。这种优化不依赖于具体的计算机。</p>
</li>
<li><p>另一种优化则主要针对目标代码的生成而进行的。</p>
</li>
</ul>
<p>上图中，我们将优化阶段放在编译程序的后面，这是一种比较笼统的表示。</p>
<ul>
<li>对于前一种优化，主要的工作是删除公共表达式、循环优化（代码外提、强度削弱、变换循环控制条件、已知量的合并等）、复写传播，以及无用赋值的删除，等等。</li>
<li>后一种类型的优化同机器的硬件结构密切相关，最主要的是考虑是如何充分利用机器的各个硬件寄存器存放的有关变量的值，以减少对于内存的访问次数。另外，如何根据机器硬件执行指令的特点（如流水线、RISC、CISC、VLIW等）而对指令进行一些调整使目标代码比较短，执行的效率比较高，也是一个重要的研究课题。</li>
</ul>
<p>经过优化得到的汇编代码必须经过汇编程序的汇编转换成相应的机器指令，方可能被机器执行。</p>
<h2 id="汇编过程"><a href="#汇编过程" class="headerlink" title="汇编过程"></a>汇编过程</h2><p>汇编过程实际上指把汇编语言代码翻译成目标机器指令的过程。对于被翻译系统处理的每一个C语言源程序，都将最终经过这一处理而得到相应的目标文件。</p>
<p><strong>目标文件中所存放的也就是与源程序等效的目标的机器语言代码。</strong></p>
<p>目标文件由段组成。通常一个目标文件中至少有两个段：</p>
<ul>
<li>代码段。该段中所包含的主要是程序的指令。该段一般是可读和可执行的，但一般却不可写。</li>
<li>数据段。主要存放程序中要用到的各种全局变量或静态的数据。一般数据段都是可读，可写，可执行的。</li>
</ul>
<p>主要有三种类型的目标文件：</p>
<ul>
<li>可重定位文件。其中包含有适合于其它目标文件链接来创建一个可执行的或者共享的目标文件的代码和数据。</li>
<li>共享的目标文件。这种文件存放了适合于在两种上下文里链接的代码和数据。第一种事链接程序可把它与其它可重定位文件及共享的目标文件一起处理来创建另一个目标文件；第二种是动态链接程序将它与另一个可执行文件及其它的共享目标文件结合到一起，创建一个进程映象。</li>
<li>可执行文件。它包含了一个可以被操作系统创建一个进程来执行之的文件。</li>
</ul>
<p>汇编程序生成的实际上是第一种类型的目标文件。对于后两种还需要其他的一些处理方能得到，这个就是链接程序的工作了。</p>
<h2 id="链接程序"><a href="#链接程序" class="headerlink" title="链接程序"></a>链接程序</h2><p>由汇编程序生成的目标文件并不能立即就被执行，其中可能还有许多没有解决的问题。例如，某个源文件中的函数可能引用了另一个源文件中定义的某个符号（如变量或者函数调用等）；在程序中可能调用了某个库文件中的函数，等等。所有的这些问题，都需要经链接程序的处理方能得以解决。</p>
<p>链接程序的主要工作就是将有关的目标文件彼此相连接，也即将在一个文件中引用的符号同该符号在另外一个文件中的定义连接起来，使得所有的这些目标文件成为一个能够诶操作系统装入执行的统一整体。</p>
<p>根据开发人员指定的同库函数的链接方式的不同，链接处理可分为两种：</p>
<ul>
<li>静态链接<code>.lib</code>,<code>.a</code>　在这种链接方式下，函数的代码将从其所在地静态链接库中被拷贝到最终的可执行程序中。这样该程序在被执行时这些代码将被装入到该进程的虚拟地址空间中。静态链接库实际上是一个目标文件的集合，其中的每个文件含有库中的一个或者一组相关函数的代码。(个人备注：静态链接将链接库的代码复制到可执行程序中，使得可执行程序体积变大)</li>
<li>动态链接<code>.dll</code>,<code>.so</code>　在此种方式下，函数的代码被放到称作是动态链接库或共享对象的某个目标文件中。链接程序此时所作的只是在最终的可执行程序中记录下共享对象的名字以及其它少量的登记信息。在此可执行文件被执行时，动态链接库的全部内容将被映射到运行时相应进程的虚地址空间。动态链接程序将根据可执行程序中记录的信息找到相应的函数代码。（个人备注：动态链接指的是需要链接的代码放到一个共享对象中，共享对象映射到进程虚地址空间，链接程序记录可执行程序将来需要用的代码信息，根据这些信息迅速定位相应的代码片段。）</li>
</ul>
<p>对于可执行文件中的函数调用，可分别采用动态链接或静态链接的方法。使用动态链接能够使最终的可执行文件比较短小，并且当共享对象被多个进程使用时能节约一些内存，因为在内存中只需要保存一份此共享对象的代码。但并不是使用动态链接就一定比使用静态链接要优越。在某些情况下动态链接可能带来一些性能上损害。</p>
<h1 id="include"><a href="#include" class="headerlink" title="include"></a>include</h1><h2 id="include工作"><a href="#include工作" class="headerlink" title="include工作"></a>include工作</h2><p>include头文件的处理发生在预处理过程。预处理器用指定的头文件的内容替代每个include。 </p>
<h2 id="include相互引用"><a href="#include相互引用" class="headerlink" title="include相互引用"></a>include相互引用</h2><p>使用前置声明来解决。</p>
<p>如下</p>
<pre class="line-numbers language-c++"><code class="language-c++">//文件A.h中的代码
#pragma once

#include "B.h"

class B;

class A
{
      public:
          B* b;
};
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-c++"><code class="language-c++">//文件B.h中的代码
#pragma once

#include "A.h"

class B;

class B
{
      public:
          A* a;
};
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

            </div>
            <hr/>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff;
        background-color: #22AB38;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff;
        background-color: #019FE8;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a class="reward-link btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">感谢您的支持！</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs">
                        <li class="tab wechat-tab waves-effect waves-light"><a class="active" href="#wechat">微信</a></li>
                        <li class="tab alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                    </ul>
                    <div id="wechat">
                        <img src="/res/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                    <div id="alipay">
                        <img src="/res/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('#reward .reward-link').on('click', function () {
            $('#rewardModal').openModal();
        });

        $('#rewardModal .close').on('click', function () {
            $('#rewardModal').closeModal();
        });
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">转载请注明: </span>
                    <a href="https://dybl.github.io" class="b-link-green">FunU</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2017/09/14/gcc-cpp/" class="b-link-green">G++编译C++程序</a>
                </p>
            </div>
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: 'f120cd4af15e4483511b',
        clientSecret: '0cbbd24d59314d1948516419787059bd2e44cfa7',
        repo: 'https://github.com/dybl/blog_backup',
        owner: 'dybl',
        admin: null,
        id: '2017-09-14T15-58-29',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">上一篇</div>
            <div class="card">
                <a href="/2017/09/14/nginx-conf/">
                    <div class="card-image">
                        
                        
                        <img src="/res/img/0.jpg" class="responsive-img" alt="nginx-conf">
                        
                        <span class="card-title">nginx-conf</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">nginx.conf
参照
# 定义Nginx运行的用户和用户组。window下不指定
user www www;

# nginx进程数，建议设置为等于CPU总核心数
worker_processes 1;

# 全局错误日志定义类型，[</div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2017-09-14
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/GNU/" class="post-category" target="_blank">
                                    GNU
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/nginx/" target="_blank">
                        <span class="chip bg-color">nginx</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">下一篇</div>
            <div class="card">
                <a href="/2017/02/24/ml-intro/">
                    <div class="card-image">
                        
                        
                        <img src="/res/img/13.jpg" class="responsive-img" alt="ml-intro">
                        
                        <span class="card-title">ml-intro</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">通用的机器学习算法包括：
1.决策树。
2.SVM。
3.朴素贝叶斯。
4.KNN。
5.K均值。
6.随机森林。

下面是使用Python和R代码实现并简要解释这些常见机器学习算法。
1.决策树：


这是作者最喜欢的算法之一，作者经常使</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2017-02-24
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Arithmetic/" class="post-category" target="_blank">
                                    Arithmetic
                                </a>
                            
                            <a href="/categories/Arithmetic/ML/" class="post-category" target="_blank">
                                    ML
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/algorithms/" target="_blank">
                        <span class="chip bg-color">algorithms</span>
                    </a>
                    
                    <a href="/tags/python/" target="_blank">
                        <span class="chip bg-color">python</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>
    </div>
    <div class="col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title">目录</div>
            <div id="toc-content">

            </div>
        </div>
    </div>
</div>

<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });
    });
</script>
    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            2016-2019 &copy;<a href="https://dybl.github.io" target="_blank"> FunU CO.,LTD </a>
            <img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png">
            全文在<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">署名-非商业-相同方式共享</a>许可下获得
            
        </div>
        <div class="col s12 m4 l4 social-link"><a href="https://github.com/" class="tooltipped" target="_blank" data-tooltip="-> Gituhb"
    data-position="top" data-delay="50">
    <i class="fa fa-github fa-lg"></i>
</a>
<a href="https://twitter.com" class="tooltipped" data-tooltip="-> Twitter" data-position="top" data-delay="50">
    <i class="fa fa-twitter fa-lg"></i>
</a>
<a href="https://facebook.com" class="tooltipped" data-tooltip="-> Facebook" data-position="top" data-delay="50">
    <i class="fa fa-facebook-official fa-lg"></i>
</a>
<a href="https://instagram.com" class="tooltipped" data-tooltip="-> Ins" data-position="top" data-delay="50">
    <i class="fa fa-instagram fa-lg"></i>
</a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>



<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title">搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input" autofocus="">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/js/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->


</body>
</html>